<div class="view-control-panel">
  <div class="workshops-count" fxFlex="1 1" fxLayout="row" fxLayoutAlign="space-between center">
    <h3>Знайдено {{(filteredWorkshops$ | async)?.totalAmount}} гуртків</h3>
    <ng-template [ngTemplateOutlet]="filterButton"></ng-template>
  </div>
  <div class="workshops-search" fxFlex fxLayout.lt-lg="row wrap" fxLayout="row" fxLayoutAlign.lt-lg="center center"
    fxLayoutAlign="space-between center">
    <ng-template [ngTemplateOutlet]="searchBlock"></ng-template>
  </div>
  <app-scroll-to-top *ngIf="(isMobileScreen$ | async)"></app-scroll-to-top>
</div>

<mat-drawer-container>
  <mat-drawer mode="side" [(opened)]="isFiltersVisible">
    <app-filters-list [resetFilter$]="resetFilter$"></app-filters-list>
  </mat-drawer>
  <mat-drawer-content [style.marginLeft]="isFiltersVisible ? '326px' : '0'">
    <div *ngIf="currentView === viewType.map; else ShowData;" fxLayout='row wrap' fxLayoutAlign='start'>
      <app-workshop-map-view-list [role]="role$ | async" [filteredWorkshops$]="filteredWorkshops$"
        [resetFilter$]="resetFilter$"></app-workshop-map-view-list>
    </div>
    <ng-template #ShowData>
      <app-workshop-cards-list class="cards" [role]="role$ | async" [workshops$]="filteredWorkshops$"
        [resetFilter$]="resetFilter$"></app-workshop-cards-list>
    </ng-template>
  </mat-drawer-content>
</mat-drawer-container>

<ng-template #filterButton>
  <button class="filters-toggle-btn" [ngClass]="isFiltersVisible ? 'visible' : 'hidden'"
    (click)="isFiltersVisible = !isFiltersVisible">
    <span class="material-icons btn-icon">
      <mat-icon *ngIf="isFiltersVisible; else hidden">filter_alt</mat-icon>
      <ng-template #hidden>
        <mat-icon>filter_alt</mat-icon>
      </ng-template>
    </span>
  </button>
</ng-template>

<ng-template #searchBlock>
  <app-full-search-bar></app-full-search-bar>
  <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap='1rem'>
    <ng-template [ngTemplateOutlet]="filterButton"></ng-template>
    <app-ordering [resetFilter$]="resetFilter$"></app-ordering>
    <mat-button-toggle-group class="view-toggle" #group="matButtonToggleGroup" [value]="currentView"
      (change)="viewHandler(group.value)">
      <mat-button-toggle value="{{viewType.data}}" aria-label="{{viewType.data}}" fxLayout="row"
        fxLayoutAlign="center center">
        <mat-icon class="view-toggle_icon_small">view_module</mat-icon>
        <span class="view-toggle_icon">Список</span>
      </mat-button-toggle>
      <mat-button-toggle value="{{viewType.map}}" aria-label="{{viewType.map}}" fxLayout="row"
        fxLayoutAlign="center center">
        <mat-icon class="view-toggle_icon_small">map</mat-icon>
        <span class="view-toggle_icon">Карта</span>
      </mat-button-toggle>
    </mat-button-toggle-group>
  </div>
</ng-template>