<div class="import-buttons">
  <div class="file-actions">
    <div>
      <button class="submit-btn" type="button" mat-raised-button (click)="fileInput.click()">
        {{ dataSource ? ('IMPORT/EXPORT.SELECT_ANOTHER_FILE' | translate) : ('IMPORT/EXPORT.SELECT_FILE' | translate) }}
      </button>
      <input hidden (change)="onFileSelected($event)" #fileInput type="file" accept=".xlsx" />
      <span class="file-name">{{ selectedFile?.name }}</span>
    </div>
    <div class="loader-container">
      <div class="loader" *ngIf="isLoading"></div>
    </div>
    <button *ngIf="dataSource" class="btn" mat-raised-button [disabled]="dataSourceInvalid.length > 0" (click)="sendValidProviders()">
      {{ 'IMPORT/EXPORT.SUBMIT_FILE' | translate }}
    </button>
  </div>
  <div class="errors-menu">
    <div class="length-warning" *ngIf="isWarningVisible">
      <mat-card-subtitle>{{ 'IMPORT/EXPORT.HUNDRED_WARNING' | translate }}</mat-card-subtitle>
    </div>
    <ng-container *ngIf="dataSourceInvalid?.length">
      <mat-slide-toggle [(ngModel)]="isToggle" color="warn">
        <span class="incorrect-row">{{ 'IMPORT/EXPORT.INCORRECT_ROWS' | translate }}</span>
        <span class="incorrect-row-number">{{ dataSourceInvalid.length }}</span>
      </mat-slide-toggle>
    </ng-container>
    <app-info-menu *ngIf="dataSourceInvalid?.length" style="font-size: 20px; margin-bottom: 10px; display: flex" [isBigIcon]="true">
      <div class="errors-types">
        <h3>{{ 'IMPORT/EXPORT.ERRORS.ERRORS_TYPES' | translate }}</h3>
        <ul>
          <li>
            <div class="color-box error-field-duplicate"></div>
            <p>{{ 'IMPORT/EXPORT.ERRORS.DATA_DUPLICATE' | translate }}</p>
          </li>
          <li>
            <div class="color-box error-field-empty"></div>
            <p>{{ 'IMPORT/EXPORT.ERRORS.MISSING_INFO_EMPTY_FIELD' | translate }}</p>
          </li>
          <li>
            <div class="color-box error-field-wrong-length"></div>
            <p>{{ 'IMPORT/EXPORT.ERRORS.WRONG_LENGTH' | translate }}</p>
          </li>
          <li>
            <div class="color-box error-field-wrong-format"></div>
            <p>{{ 'IMPORT/EXPORT.ERRORS.WRONG_FORMAT' | translate }}</p>
          </li>
          <li>
            <div class="color-box error-field-wrong-language"></div>
            <p>{{ 'IMPORT/EXPORT.ERRORS.WRONG_LANGUAGE' | translate }}</p>
          </li>
        </ul>
      </div>
    </app-info-menu>
  </div>
</div>

<ng-container *ngIf="isToggle ? dataSourceInvalid : dataSource">
  <div class="wrapper-provider-list">
    <div class="wrapper-provider-list-container">
      <div class="table-container mat-elevation-z8">
        <table mat-table [dataSource]="isToggle ? dataSourceInvalid : dataSource" class="custom-table-style">
          <ng-container matColumnDef="sequenceNumber">
            <th mat-header-cell *matHeaderCellDef>â„–</th>
            <td mat-cell style="min-width: 30px" *matCellDef="let element">{{ dataSource.indexOf(element) + 1 }}</td>
          </ng-container>
          <ng-container matColumnDef="directorsName">
            <th mat-header-cell *matHeaderCellDef>{{ 'IMPORT/EXPORT.PROVIDERS_LIST.DIRECTORS_NAME' | translate }}</th>
            <td
              mat-cell
              *matCellDef="let element"
              [ngClass]="{ 'error-field-empty': element.errors.directorsNameEmpty }"
              [matTooltip]="element.directorsName"
              showTooltipIfTruncated
              matTooltipPosition="right"
              matTooltipClass="import-providers-table-tooltip">
              {{ element.directorsName }}
            </td>
          </ng-container>
          <ng-container matColumnDef="directorsSurname">
            <th mat-header-cell *matHeaderCellDef>{{ 'IMPORT/EXPORT.PROVIDERS_LIST.DIRECTORS_SURNAME' | translate }}</th>
            <td
              mat-cell
              *matCellDef="let element"
              [ngClass]="{ 'error-field-empty': element.errors.directorsSurnameEmpty }"
              [matTooltip]="element.directorsSurname"
              showTooltipIfTruncated
              matTooltipPosition="right"
              matTooltipClass="import-providers-table-tooltip">
              {{ element.directorsSurname }}
            </td>
          </ng-container>
          <ng-container matColumnDef="providerName">
            <th mat-header-cell *matHeaderCellDef>{{ 'IMPORT/EXPORT.PROVIDERS_LIST.PROVIDER_NAME' | translate }}</th>
            <td
              mat-cell
              *matCellDef="let element"
              [ngClass]="{
                'error-field-empty': element.errors.providerNameEmpty,
                'error-field-wrong-length': element.errors.providerNameLength
              }"
              [matTooltip]="element.providerName"
              showTooltipIfTruncated
              matTooltipPosition="right"
              matTooltipClass="import-providers-table-tooltip">
              {{ element.providerName }}
            </td>
          </ng-container>
          <ng-container matColumnDef="ownership">
            <th mat-header-cell *matHeaderCellDef>{{ 'IMPORT/EXPORT.PROVIDERS_LIST.OWNERSHIP' | translate }}</th>
            <td mat-cell *matCellDef="let element" [ngClass]="{ 'error-field-empty': element.errors.ownershipEmpty }">
              {{ element.ownership }}
            </td>
          </ng-container>
          <ng-container matColumnDef="identifier">
            <th mat-header-cell *matHeaderCellDef>{{ 'IMPORT/EXPORT.PROVIDERS_LIST.IDENTIFIER' | translate }}</th>
            <td
              mat-cell
              *matCellDef="let element"
              [ngClass]="{
                'error-field-empty': element.errors.identifierEmpty,
                'error-field-duplicate': element.errors.identifierDuplicate,
                'error-field-wrong-format': element.errors.identifierFormat
              }">
              {{ element.identifier }}
            </td>
          </ng-container>
          <ng-container matColumnDef="licenseNumber">
            <th mat-header-cell *matHeaderCellDef>{{ 'IMPORT/EXPORT.PROVIDERS_LIST.LICENSE_NUMBER' | translate }}</th>
            <td mat-cell *matCellDef="let element" [ngClass]="{ 'error-field-empty': element.errors.licenseNumberEmpty }">
              {{ element.licenseNumber }}
            </td>
          </ng-container>
          <ng-container matColumnDef="settlement">
            <th mat-header-cell *matHeaderCellDef>{{ 'IMPORT/EXPORT.PROVIDERS_LIST.SETTLEMENT' | translate }}</th>
            <td
              mat-cell
              *matCellDef="let element"
              [ngClass]="{
                'error-field-empty': element.errors.settlementEmpty,
                'error-field-wrong-length': element.errors.settlementLength,
                'error-field-wrong-language': element.errors.settlementLanguage
              }"
              [matTooltip]="element.settlement"
              showTooltipIfTruncated
              matTooltipPosition="right"
              matTooltipClass="import-providers-table-tooltip">
              {{ element.settlement }}
            </td>
          </ng-container>
          <ng-container matColumnDef="address">
            <th mat-header-cell *matHeaderCellDef>{{ 'IMPORT/EXPORT.PROVIDERS_LIST.ADDRESS' | translate }}</th>
            <td
              mat-cell
              *matCellDef="let element"
              [ngClass]="{
                'error-field-empty': element.errors.addressEmpty,
                'error-field-wrong-language': element.errors.addressLanguage
              }"
              [matTooltip]="element.address"
              showTooltipIfTruncated
              matTooltipPosition="left"
              matTooltipClass="import-providers-table-tooltip">
              {{ element.address }}
            </td>
          </ng-container>
          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef>{{ 'IMPORT/EXPORT.PROVIDERS_LIST.EMAIL' | translate }}</th>
            <td
              mat-cell
              *matCellDef="let element"
              [ngClass]="{
                'error-field-empty': element.errors.emailEmpty,
                'error-field-duplicate': element.errors.emailDuplicate,
                'error-field-wrong-format': element.errors.emailFormat
              }"
              [matTooltip]="element.email"
              showTooltipIfTruncated
              matTooltipPosition="left"
              matTooltipClass="import-providers-table-tooltip">
              {{ element.email }}
            </td>
          </ng-container>
          <ng-container matColumnDef="phoneNumber">
            <th mat-header-cell *matHeaderCellDef>{{ 'IMPORT/EXPORT.PROVIDERS_LIST.PHONE_NUMBER' | translate }}</th>
            <td
              mat-cell
              *matCellDef="let element"
              [ngClass]="{
                'error-field-empty': element.errors.phoneNumberEmpty,
                'error-field-wrong-format': element.errors.phoneNumberFormat
              }">
              {{ element.phoneNumber }}
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </div>
    </div>
  </div>
</ng-container>
<button *ngIf="isGoTopBtnVisible" class="go-to-top" (click)="gotoTop()"><i class="fas fa-arrow-up"></i></button>
