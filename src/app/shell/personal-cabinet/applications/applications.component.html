<div class="container" *ngIf="(userRole === role.provider) then isProvider; else isParent"></div>


<ng-template #isProvider>
  <app-workshop-checkbox-dropdown class="dropdown" [workshops]="workshops$ | async"
    (workshopCheck)="onWorkshopsSelect($event)">
  </app-workshop-checkbox-dropdown>
  <div class="tab-wrapper">
    <mat-tab-group mat-align-tabs="start" (selectedTabChange)="onTabChange($event)">
      <mat-tab label="{{applicationTitles[applicationStatus.all]}}">
        <ng-container *ngTemplateOutlet="ProviderApplication; context:{$implicit: applications$ | async }">
        </ng-container>
      </mat-tab>
      <mat-tab label="{{applicationTitles[applicationStatus.pending]}}">
        <ng-container *ngTemplateOutlet="ProviderApplication; context:{$implicit: applications$| async }">
        </ng-container>
      </mat-tab>s
      <mat-tab label="{{applicationTitles[applicationStatus.approved]}}">
        <ng-container *ngTemplateOutlet="ProviderApplication; context:{$implicit: applications$ | async }">
        </ng-container>
      </mat-tab>
      <mat-tab label="{{applicationTitles[applicationStatus.rejected]}}">
        <ng-container *ngTemplateOutlet="ProviderApplication; context:{$implicit: applications$ | async }">
        </ng-container>
      </mat-tab>
      <mat-tab label="{{applicationTitles[applicationStatus.left]}}">
        <ng-container *ngTemplateOutlet="ProviderApplication; context:{$implicit: applications$ | async }">
        </ng-container>
      </mat-tab>
    </mat-tab-group>
  </div>

</ng-template>

<ng-template #isEmptyList>
  <app-no-result-card [title]="noApplicationTitle"></app-no-result-card>
</ng-template>

<ng-template #isParent>
  <ng-container *ngIf="!(isLoadingCabinet$ | async)">

    <div class="container" *ngIf="(children$| async)?.length else isEmptyList">
      <div *ngFor="let child of (children$| async)">
        <div
          *ngIf="(applications$ | async | applicationChildFilter : child)?.length then ChildApplication; else isEmptyList">
        </div>

        <ng-template #ChildApplication>
          <h3> {{ child.firstName }} {{ child.lastName }} {{ child.middleName }}</h3>
          <ng-container
            *ngTemplateOutlet="Applications; context:{$implicit: applications$ | async | applicationChildFilter : child }">
          </ng-container>
        </ng-template>

      </div>

    </div>
  </ng-container>
</ng-template>

<ng-template #Applications let-applications>
  <app-application-card *ngFor="let application of applications" [application]="application" [userRole]="userRole"
    (approved)="onApprove($event)" (rejected)="onReject($event)" (leave)="onLeave($event)"
    (infoShow)="onInfoShow($event)" (infoHide)="onInfoHide()">
  </app-application-card>
</ng-template>

<ng-template #ProviderApplication let-applications>
  <ng-container *ngIf="!(isLoadingCabinet$ | async) && applications?.length else isEmptyList">
    <ng-container *ngTemplateOutlet="Applications; context: applications">
    </ng-container>
  </ng-container>
</ng-template>


<ng-template appInfoBoxHost></ng-template>